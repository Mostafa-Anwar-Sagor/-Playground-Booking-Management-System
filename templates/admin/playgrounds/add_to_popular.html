{% extends "admin/base_site.html" %}

{% block title %}Add to Popular{% endblock %}

{% block extrastyle %}
<style>
    .playground-list { background: white; border: 1px solid #ddd; margin: 20px 0; }
    .playground-item { padding: 12px 16px; border-bottom: 1px solid #f0f0f0; display: flex; align-items: center; gap: 12px; cursor: pointer; transition: background 0.2s; }
    .playground-item:hover { background: #f9fafb; }
    .playground-item.selected { background: #ecfdf5; border-left: 4px solid #10b981; }
    .playground-item input { width: 18px; height: 18px; cursor: pointer; }
    .playground-info { flex: 1; }
    .playground-name { font-size: 15px; font-weight: 600; color: #111; margin: 0; }
    .playground-details { font-size: 13px; color: #666; margin: 2px 0 0 0; }
    .playground-price { font-weight: 600; color: #10b981; margin-left: auto; }
    .action-bar { background: #f9fafb; padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #ddd; }
    .submit-bar { position: sticky; bottom: 0; background: white; padding: 16px; border-top: 2px solid #ddd; display: flex; justify-content: space-between; box-shadow: 0 -2px 8px rgba(0,0,0,0.1); }
    .btn { padding: 10px 20px; border: none; border-radius: 4px; font-size: 14px; font-weight: 600; cursor: pointer; text-decoration: none; display: inline-block; }
    .btn-primary { background: #10b981; color: white; }
    .btn-primary:hover { background: #059669; }
    .btn-primary:disabled { background: #9ca3af; cursor: not-allowed; }
    .btn-secondary { background: #6b7280; color: white; }
    .btn-secondary:hover { background: #4b5563; }
    .empty { text-align: center; padding: 40px; color: #666; }
</style>
{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">Home</a> &rsaquo;
    <a href="{% url 'admin:playgrounds_popularplayground_changelist' %}">Popular Playgrounds</a> &rsaquo;
    Add
</div>
{% endblock %}

{% block content %}
<h1>Add to Popular Section</h1>
<p style="color:#666;margin-bottom:20px;">Select playgrounds to add to homepage popular section.</p>

{% if available_playgrounds %}
<form method="post">
    {% csrf_token %}
    <div class="action-bar">
        <div><input type="checkbox" id="select-all"> <label for="select-all" style="margin-left:8px;cursor:pointer;">Select All ({{ available_playgrounds.count }})</label></div>
        <span id="count" style="font-weight:600;">0 selected</span>
    </div>
    <div class="playground-list">
        {% for pg in available_playgrounds %}
        <div class="playground-item">
            <input type="checkbox" name="playgrounds" value="{{ pg.id }}" class="cb">
            <div class="playground-info">
                <div class="playground-name">{{ pg.name }}</div>
                <div class="playground-details">üìç {{ pg.city.name|default:"Unknown" }}{% if pg.city.state.country %}, {{ pg.city.state.country.name }}{% endif %} ‚Ä¢ {{ pg.owner.email }}{% if pg.rating %} ‚Ä¢ ‚≠ê {{ pg.rating|floatformat:1 }}{% endif %}</div>
            </div>
            <div class="playground-price">{% if pg.city.state.country.code == "US" %}${% elif pg.city.state.country.code == "GB" %}¬£{% elif pg.city.state.country.code == "MY" %}RM{% else %}${% endif %}{{ pg.price_per_hour|floatformat:0 }}/hr</div>
        </div>
        {% endfor %}
    </div>
    <div class="submit-bar">
        <a href="{% url 'admin:playgrounds_popularplayground_changelist' %}" class="btn btn-secondary">Cancel</a>
        <button type="submit" class="btn btn-primary" id="submit" disabled>Add to Popular</button>
    </div>
</form>
<script>
const items=document.querySelectorAll('.playground-item'),cbs=document.querySelectorAll('.cb'),all=document.getElementById('select-all'),btn=document.getElementById('submit'),cnt=document.getElementById('count');
function upd(){const s=document.querySelectorAll('.cb:checked').length;cnt.textContent=s+' selected';btn.disabled=!s;}
items.forEach(i=>{const c=i.querySelector('.cb');i.addEventListener('click',e=>{if(e.target!==c)c.checked=!c.checked;i.classList.toggle('selected',c.checked);upd();});c.addEventListener('change',()=>{i.classList.toggle('selected',c.checked);upd();});});
if(all)all.addEventListener('change',function(){cbs.forEach(c=>{c.checked=this.checked;c.closest('.playground-item').classList.toggle('selected',this.checked);});upd();});
</script>
{% else %}
<div class="empty"><h2>All Already Popular</h2><p>No more playgrounds to add.</p><a href="{% url 'admin:playgrounds_popularplayground_changelist' %}" class="btn btn-secondary">Back</a></div>
{% endif %}
{% endblock %}
